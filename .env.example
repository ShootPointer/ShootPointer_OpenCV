# =========================
# 기본 자르기 길이(초) / 최대 클립 수
# =========================
DEFAULT_PRE=5.0
DEFAULT_POST=5.0
MAX_CLIPS=10

# =========================
# 자동 후보(오디오)
# =========================
SILENCE_THRESHOLD_DB=-28
SILENCE_MIN_DUR=0.30
AUTO_TOPK=5

# =========================
# 등번호 감지(OpenCV + Tesseract)
# =========================
JERSEY_SAMPLE_FPS=1.5
JERSEY_MIN_SEG_DUR=1.2
JERSEY_MERGE_GAP=2.0
JERSEY_TESSERACT_PSM=7
JERSEY_TESSERACT_OEM=3
JERSEY_NUM_CONF=0.5

# 단일 글자 우선 세팅 (필요시 조정)
OCR_PSMS=10,8,7
OCR_TRY_INVERT=0
OCR_SCALES=2.0

# 타임아웃/예산
OCR_TIMEOUT_SEC=5
OCR_MAX_COMBOS=120
OCR_MAX_SEC=8
DEBUG_OCR=0

# =========================
# 실행/안정화
# =========================
LOG_LEVEL=INFO
REQUEST_LOG_BODY=false
FFMPEG_TIMEOUT_SEC=120
MAX_UPLOAD_BYTES=209715200

# =========================
# GPU / 하드웨어 가속
# =========================
USE_CUDA=true
CUDA_RESIZE_MAX=1920

# FFmpeg 하드웨어 디코드 (NVIDIA라면 nvdec)
# ※ 컨테이너가 NVIDIA 런타임일 때만 유효
FF_HWACCEL=nvdec
FF_HWACCEL_DEVICE=0

# (선택) 컷 실패시 재인코드 폴백 켜기
FFMPEG_CUT_FALLBACK_REENCODE=1
# (선택) 재인코드 파라미터 튜닝
FFMPEG_THREADS=0
FFMPEG_REENC_VCODEC=libx264
FFMPEG_REENC_PRESET=veryfast
FFMPEG_REENC_CRF=23
FFMPEG_REENC_ACODEC=aac

# =========================
# 프리사인드 업로드(게이트웨이 ↔ OpenCV 서버)
# =========================
PRE_SIGNED_SECRET=GWzLpvV0E+QgAGDxJstwbMsiw1Ibx2PqW+FSAREfT5F8M1vMiZzy8/ysNWXHeaSnLTy4ZmF7w5+GvWbU2ZQeLw==
PRESIGNED_EXPIRES_MIN=30
UPLOAD_DIR=/tmp/uploads
UPLOAD_CHUNK_MAX_MB=200

# CORS
ALLOW_ORIGINS=*

# =========================
# 콜백/백엔드 연동(옵션) & 다운로드 타임아웃
# =========================
BACKEND_SECRET=
CALLBACK_CONNECT_TIMEOUT=30
CALLBACK_READ_TIMEOUT=60
CALLBACK_WRITE_TIMEOUT=60

# =========================
# Redis / 진행률
# =========================
REDIS_URL=redis://redis:6379/0
PROGRESS_PUBLISH_INTERVAL_SEC=5
REDIS_UPLOAD_CHANNEL=upload_progress
REDIS_PROCESS_CHANNEL=process_progress

# =========================
# 파일 저장/정적 URL
# =========================
SAVE_ROOT=/data/highlights
# 개발(FastAPI 직접 서빙):
# STATIC_BASE_URL=http://localhost:8000/static/highlights
# 운영(Nginx 서빙):
STATIC_BASE_URL=https://your-domain/static/highlights

# =========================
# 결과 KV 저장 설정 (백엔드 요구사항)
# =========================
PUBLISH_RESULT_AS_KV=true
RESULT_KEY_PREFIX=highlight-
RESULT_TTL_SECONDS=86400

# =========================
# 하이라이트 발행 정책
# =========================
PUBLISH_THRESHOLD=2


# ============================================================
# [신규/보강] FFmpeg 오버레이/출력 튜닝 (drawtext/세로해상도/품질)
# ============================================================
# Shorts 세로 해상도 (코드 기본 1080x1920, 필요 시만 변경)
SHORTS_WIDTH=1080
SHORTS_HEIGHT=1920

# drawtext 폰트 경로 (Docker 기본 폰트로 안전값)
# - 리눅스 컨테이너: /usr/share/fonts/truetype/dejavu/DejaVuSans.ttf
# - Windows 호스트 직접 실행이라면 예: C\:\\Windows\\Fonts\\arial.ttf
DRAW_FONTFILE=/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf
DRAW_FONTSIZE=48

# FFmpeg 인코딩 품질/속도
FFMPEG_PRESET=veryfast
FFMPEG_CRF=20
FFMPEG_ABR=128k

# ============================================================
# [신규/보강] 탐지/정확도 환경 파라미터 (코드 수정 없이 튜닝)
# ============================================================
# 다운스케일 기준(긴 변 / SCALE_BASE): 낮추면 속도↑, 높이면 정확도↑
SCALE_BASE=960

# 공(오렌지) HSV 범위 (필요시 체육관/카메라 색감에 따라 조절)
BALL_HSV_MIN=5,60,60
BALL_HSV_MAX=25,255,255

# 코트 라인 검출(HoughLinesP) 파라미터
HOUGH_MIN_LINE_RATIO=0.25     # minLineLength = ratio * frame_width
HOUGH_MAX_GAP=20
HOUGH_THRESH=120

# Homography RANSAC 오차 허용(픽셀)
HOMO_RANSAC_REPROJ_THRESH=3.0
